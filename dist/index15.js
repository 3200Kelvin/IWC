import{l as b,m as h,p as S,f as q,S as g,q as k}from"./index.js";const P=(s,r,l)=>{const n={x:0,y:0},t={x:0,y:0},i=1,e=gsap.utils.interpolate;gsap.ticker.add(v),s.classList.add("moving-tooltip");const a=[...l].map(o=>{return o.addEventListener("mouseenter",m),()=>{o.removeEventListener("mouseenter",m),o.removeEventListener("mouseleave",y)};function m(){s.classList.add("shown"),o.addEventListener("mouseleave",y)}function y(){s.classList.remove("shown"),o.removeEventListener("mouseleave",y)}});return r.addEventListener("mouseenter",p),()=>{gsap.ticker.remove(v),r.removeEventListener("mouseenter",p),r.removeEventListener("mousemove",f),r.removeEventListener("mouseleave",c),a.forEach(o=>o())};function v(){t.x=e(t.x,n.x,.05),t.y=e(t.y,n.y,.05);const o=t.x*i,m=t.y*i;u(o,m)}function f(o){n.x=o.clientX,n.y=o.clientY}function p(o){d(o.clientX,o.clientY),r.addEventListener("mousemove",f),r.addEventListener("mouseleave",c)}function c(o){r.removeEventListener("mousemove",f)}function d(o,m){n.x=o,n.y=m,t.x=o,t.y=m;const y=t.x*i,L=t.y*i;u(y,L)}function u(o,m){gsap.set(s,{x:o,y:m})}};async function E(s){const r=s.querySelector('[data-video="container"]'),{play:l,pause:n,getIsPlaying:t,cleanup:i}=b(r);return s.addEventListener("click",e),()=>{i(),s.removeEventListener("click",l)};function e(){t()?n():l()}}const M=()=>{const s=document.querySelector(".media");if(!s)return;const r=[];return s.querySelectorAll('.media__content [data-gated-post="post"]').forEach(t=>{t.classList.add("unblocked"),n(t)}),()=>{r.forEach(t=>t==null?void 0:t())};async function n(t){if(!t.querySelector('[data-video="container"]'))return;const e=await E(t);r.push(e)}},A=()=>{const s=document.querySelector(".media");if(!s)return;const r=document.querySelector(".media__content"),l=r.querySelectorAll('[data-gated-post="post"]'),n=r.querySelector(".media__enter-button");let t=!1;const i=[];return h().then(e),()=>{i.forEach(c=>c==null?void 0:c())};function e(c){t=S(c),t&&r.classList.add("subscribed");const d=[...l].filter(a);if(!q){const u=P(n,s,d);i.push(u)}}function a(c){const u=!!c.querySelector('[data-gated-post="is-open"]')||t;return p(c,u),f(c,u),v(c,u),!u}function v(c,d=!1){c.classList.toggle("unblocked",d)}async function f(c,d=!1){const u=c.querySelector('[data-video="container"]');if(!u)return;if(!d){u.removeAttribute("data-video-url");return}const o=await E(c);i.push(o)}function p(c,d=!1){const u=c.querySelector('[data-gated-post="true-link"]');if(u){const o=u.getAttribute("href");u.remove();const m=c.querySelector('[data-gated-post="link"]');m&&d&&m.setAttribute("href",o)}}},_=()=>{const s="collections",r=g.get(s);if(r){t(r);return}const l=k.getCollections();let n=null;return new Promise((e,a)=>{n=a}),Promise.all([l,n]).then(([e])=>t(e)),n;function t(e){g.set(s,e),e.forEach(({id:a,name:v,count:f})=>{const p=document.querySelectorAll(`[data-collection-title="${a}"]`),c=document.querySelectorAll(`[data-collection-number="${a}"]`);p.forEach(d=>i(d,v)),c.forEach(d=>{const u=d.dataset.collectionNumberDecrement?parseInt(d.dataset.collectionNumberDecrement):0;i(d,f-u)})})}function i(e,a){e.textContent=a}},x=s=>{const r=s.querySelectorAll("[data-tab]");if(!r.length)return;let l=null;const n=[...r].reduce((e,a)=>{const v=a.dataset.tab,f=s.querySelector(`[data-tab-trigger="${v}"]`);return e[v]={tab:a,trigger:f},e},{}),t=Object.entries(n).map(([e,{trigger:a}])=>(a.addEventListener("click",()=>i(e)),()=>a.removeEventListener("click",()=>i(e))));return i(r[0].dataset.tab),()=>t.forEach(e=>e());function i(e){if(!l){Object.entries(n).filter(([a])=>a!==e).forEach(([a,{tab:v}])=>v.style.display="none"),n[e].trigger.classList.add("active"),l=e;return}l!==e&&(n[l].trigger.classList.remove("active"),n[e].trigger.classList.add("active"),gsap.timeline().to(n[l].tab,{opacity:0,duration:.4}).to(n[l].tab,{display:"none"}).to(n[e].tab,{display:"block"}).to(n[e].tab,{opacity:1,duration:.4}).add(()=>l=e))}},C=()=>{const s=document.querySelector(".media--intelligence");if(s)return x(s)};export{_ as a,M as b,A as c,C as u};
